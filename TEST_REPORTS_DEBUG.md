# ?? ????? ????? ???????? ??????? - ??? ????? ???????

## ? ????????? ???????:

### 1. ????? ????? Syntax ?? generalReports.ts
- ? ????? Promise.all syntax errors
- ? ????? ????????? Expenses ? Purchases
- ? ????? installments ?? `dueDate` ??? `createdAt` (??? accounting.ts)
- ? ????? ????? ??????? ????????? ??????????

### 2. ????? Debug Logging ?? 3 ?????:
- ? `server/routers/reports.ts` - ???? `summary`
- ? `server/routers/accounting.ts` - ???? `overallFinancials`
- ? `server/routers/generalReports.ts` - ???? `overviewReport`

### 3. ?????? ?? COALESCE
???? ??????????? ?????? ????:
```sql
COALESCE(SUM(...), 0)
```

## ?? ????? ???????:

### ???? 1: ????? ??????? ??????? Console
```bash
cd "D:\new project\GTD-manage\GTD-manage"
npm run dev
```

### ???? 2: ??? ??????? ???? ??? Console

#### ???? ???????? - ????????:
1. ????: `https://pro.gtd-sys.com/accounting?tab=reports`
2. ???? DevTools (F12)
3. ???? ???? Console
4. ???? ??: `?? Reports Summary Debug:`
5. ???? ??? ?? "?????" ?? ???????

#### ???? ???????? - ?????? ?????? (??????):
1. ????: `https://pro.gtd-sys.com/accounting`
2. ???? DevTools (F12)
3. ???? ???? Console
4. ???? ??: `?? Overall Financials Debug:`

#### ???? ???????? ?????? - ???? ????:
1. ????: `https://pro.gtd-sys.com/general-reports`
2. ???? DevTools (F12)
3. ???? ???? Console
4. ???? ??: `?? General Reports Overview Debug:`

### ???? 3: ??? ???????

**??? ???? ????? ???? ?? Console:**
- ? ??????? ?? ????? ???????? (?? ???? ?????? ?? ???????? ?????)
- ? ???? ?? ??????????? SQL ?????

**??? ???? ????? ????? ?? Console ??? ??????? ???? ???:**
- ? ??????? ?? ??????? ???????? (Frontend)
- ? ???? ?? ????? ????? ???????? ?? ??? Components

## ?? ?????? ????????:

### ???? 1: ??? ???? ??????? ?? ????? ????????

???? ?? ???????? ???????? ??? ???????????:

```sql
-- 1. ???? ?? ???? ?????? ?????? ?? ????? ???????
SELECT COUNT(*) as count, COALESCE(SUM(total), 0) as total
FROM invoices 
WHERE type = 'invoice' 
  AND status = 'paid'
  AND issueDate >= '2025-01-01'
  AND issueDate <= '2025-12-31';

-- 2. ???? ?? ???? ???????
SELECT COUNT(*) as count, COALESCE(SUM(amount), 0) as total
FROM expenses 
WHERE status IN ('active', 'processing', 'completed')
  AND expenseDate >= '2025-01-01'
  AND expenseDate <= '2025-12-31';

-- 3. ???? ?? ???? ??????? ??????
SELECT COUNT(*) as count, COALESCE(SUM(amount), 0) as total
FROM purchases 
WHERE status = 'completed'
  AND purchaseDate >= '2025-01-01'
  AND purchaseDate <= '2025-12-31';

-- 4. ???? ?? ???? ????? ??????
SELECT COUNT(*) as count, COALESCE(SUM(amount), 0) as total
FROM installments 
WHERE status = 'paid'
  AND createdAt >= '2025-01-01'
  AND createdAt <= '2025-12-31';

-- 5. ???? ?? ???? ?????? ????? ??????
SELECT COUNT(*) as count, COALESCE(SUM(amount), 0) as total
FROM sales 
WHERE status = 'completed'
  AND invoiceId IS NULL
  AND saleDate >= '2025-01-01'
  AND saleDate <= '2025-12-31';
```

**??? ???? ??????? ???:**
- ??? ?????? ??????? ????????
- ???? ?? ?? ???????? ????? (2025)
- ???? ?? ????? ???????? (status)

### ???? 2: ??? ???? ??????? ?? ???????

???? ??:
1. ?? ??? ????? ???????? ???? ???? ?? Frontend?
2. ?? ??????? ???? ???????? ?? ??? response ???? ?????
3. ?? ???? ??? JavaScript ?? Console?

## ?? ??????? ???????? ?? Console:

### ????? ????? ?? Reports Summary:
```javascript
?? Reports Summary Debug: {
  dateRange: { 
    from: '2025-01-01T00:00:00.000Z', 
    to: '2025-12-31T23:59:59.999Z' 
  },
  filters: { clientId: undefined, projectId: undefined },
  results: {
    invoicesTotal: 150000,
    invoicesCount: 15,
    paidInvoicesTotal: 100000,
    paidInvoicesCount: 10,
    purchasesTotal: 30000,
    expensesTotal: 20000,
    installmentsTotal: 15000,
    manualSalesTotal: 5000
  }
}
```

### ????? ????? ?? Overall Financials:
```javascript
?? Overall Financials Debug: {
  expenses: { 
    operational: 20000, 
    purchases: 30000, 
    total: 50000 
  },
  revenue: {
    installments: { total: 15000, paid: 15000 },
    invoices: { total: 150000, paid: 100000 },
    manualSales: 5000,
    total: 170000,
    paid: 120000
  }
}
```

### ????? ????? ?? General Reports Overview:
```javascript
?? General Reports Overview Debug: {
  dateRange: { 
    from: '2025-01-01T00:00:00.000Z', 
    to: '2025-12-31T23:59:59.999Z' 
  },
  expenses: { 
    operating: 20000, 
    purchases: 30000, 
    total: 50000 
  },
  revenue: {
    invoices: { total: 150000, paid: 100000 },
    installments: { total: 15000, paid: 15000 },
    manualSales: 5000,
    total: 170000,
    paid: 120000
  },
  netProfit: 70000
}
```

## ?? ??????? ????:

1. **?? ????**: ??? ?? ???????? ??? console.log ?? ????? ???????
2. **??????**: Debug logging ???? ?????? ????? - ??????? ??? ?? ???????
3. **??????**: ??? logging ?? ???? ?????? ??????
4. **????????**: ???? ?? ?? ???????? ?? ????? ??????? (2025)

## ?? ??? ?? ???????:

### ??? Debug Logging ??:
1. `server/routers/reports.ts` (??? ????? 125)
2. `server/routers/accounting.ts` (??? ????? 945)
3. `server/routers/generalReports.ts` (??? ????? 950)

### ?? ?? ????? ???????:
```bash
npm run build
```

## ?? ????????? ?????? ?? ??? ???????:

1. **????? Syntax Errors**: ???? ???? ????? ?? Promise.all ?? generalReports
2. **????? ???? Installments**: ??????? `createdAt` ????? ?? `dueDate`
3. **????? ????? ???????**: ????????? ?????????? ???? ????? ??? ??????
4. **Debug Logging ????**: ?? 3 ????? ?????? ???? ???????
